{% extends 'car/car_base.html' %}

{% block title %}자동차 매물 등록{% endblock %}

{% block meta %}
<meta name="description" content="자동차 매물등록 폼입니다.">
{% endblock %}

{% block car_content %}
<br>
<h5>자동차 매물 등록</h5>
<form method="post" enctype="multipart/form-data">
    <div class="form-group row">
        <label for="title" class="col-sm-2 col-form-label">제목</label>
        <div class="col-sm-10">
            <input type="text" name="title" id="title" class="form-control" {% if car %}value="{{ car['title'] }}"{% endif %} required>
        </div>
    </div>
    <hr>
    <div class="form-group row">
        <label for="" class="col-sm-2">변속기</label>
        <div class="col-sm-10">
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="transmission" id="inlineRadio1" value="AUTO" {% if car and car['transmission'] == 'AUTO' %}checked{% endif %} required>
                <label class="form-check-label" for="inlineRadio1">자동</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="transmission" id="inlineRadio2" value="MANUAL" {% if car and car['transmission'] == 'MANUAL' %}checked{% endif %}>
                <label class="form-check-label" for="inlineRadio2">수동</label>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <label for="" class="col-sm-2">연료</label>
        <div class="col-sm-10">
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="fuel" id="inlineRadio3" value="GAS" {% if car and car['fuel'] == 'GAS' %}checked{% endif %} required>
                <label class="form-check-label" for="inlineRadio3">휘발유 (가솔린)</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="fuel" id="inlineRadio4" value="DIZEL" {% if car and car['fuel'] == 'DIZEL' %}checked{% endif %}>
                <label class="form-check-label" for="inlineRadio4">디젤</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="fuel" id="inlineRadio5" value="ELECTRIC" {% if car and car['fuel'] == 'ELECTRIC' %}checked{% endif %}>
                <label class="form-check-label" for="inlineRadio5">전기</label>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <label for="car_type" class="col-sm-2 col-form-label">자동차타입</label>
        <div class="col-sm-2">
            <select id="car_type" name="car_type" class="form-control" required>
                <option disabled selected hidden>Choose...</option>
                <option value="COUPE" {% if car and car['car_type'] == 'COUPE' %}selected{% endif %}>쿠페</option>
                <option value="SEDAN" {% if car and car['car_type'] == 'SEDAN' %}selected{% endif %}>세단</option>
                <option value="WAGON" {% if car and car['car_type'] == 'WAGON' %}selected{% endif %}>웨건</option>
                <option value="SUV" {% if car and car['car_type'] == 'SUV' %}selected{% endif %}>SUV</option>
                <option value="CONVERTIBLE" {% if car and car['car_type'] == 'CONVERTIBLE' %}selected{% endif %}>컨버터블</option>
                <option value="HATCHBACK" {% if car and car['car_type'] == 'HATCHBACK' %}selected{% endif %}>해치백</option>
                <option value="LIMO" {% if car and car['car_type'] == 'LIMO' %}selected{% endif %}>리무</option>
                <option value="VAN" {% if car and car['car_type'] == 'VAN' %}selected{% endif %}>밴</option>
                <option value="TRUCK" {% if car and car['car_type'] == 'TRUCK' %}selected{% endif %}>트럭</option>
                <option value="SPORTS" {% if car and car['car_type'] == 'SPORTS' %}selected{% endif %}>스포츠</option>
                <option value="CAMPING" {% if car and car['car_type'] == 'CAMPING' %}selected{% endif %}>캠핑</option>
                <option value="BIKE" {% if car and car['car_type'] == 'BIKE' %}selected{% endif %}>바이크</option>
                <option value="RV" {% if car and car['car_type'] == 'RV' %}selected{% endif %}>RV</option>
            </select>
        </div>
    </div>
    <div class="form-group row">
        <label for="manufacturer" class="col-sm-2 col-form-label">제조사</label>
        <div class="col-sm-3">
            <input type="text" name="manufacturer" id="manufacturer" class="form-control" {% if car %}value="{{ car['manufacturer'] }}"{% endif %} required>
        </div>
    </div>
    <div class="form-group row">
        <label for="model" class="col-sm-2 col-form-label">모델</label>
        <div class="col-sm-3">
            <input type="text" name="model" id="model" class="form-control" {% if car %}value="{{ car['model'] }}"{% endif %} required>
        </div>
    </div>
    <div class="form-group row">
        <label for="seat" class="col-sm-2 col-form-label">인승</label>
        <div class="col-sm-1">
            <input type="number" name="seat" id="seat" class="form-control" min="1"{% if car %}value="{{ car['seat'] }}"{% endif %} required>
        </div>
    </div>
    <div class="form-group row">
        <label for="color" class="col-sm-2 col-form-label">색상</label>
        <div class="col-sm-3">
            <input type="text" name="color" id="color" class="form-control" {% if car %}value="{{ car['color'] }}"{% endif %} required>
        </div>
    </div>
    <hr>
    <div class="form-group row">
        <label for="" class="col-sm-2">거래종류</label>
        <div class="col-sm-10">
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="sale_type" id="inlineRadio6" value="SALE" {% if car and car['sale_type'] == 'SALE' %}checked{% endif %} required>
                <label class="form-check-label" for="inlineRadio6">매매</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="sale_type" id="inlineRadio7" value="RENT" {% if car and car['sale_type'] == 'RENT' %}checked{% endif %}>
                <label class="form-check-label" for="inlineRadio7">렌트</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="sale_type" id="inlineRadio8" value="LEASE" {% if car and car['sale_type'] == 'LEASE' %}checked{% endif %}>
                <label class="form-check-label" for="inlineRadio8">리스</label>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <label for="" class="col-sm-2">중고여부</label>
        <div class="col-sm-10">
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="used" id="inlineRadio9" value="True" {% if car and not car['used'] %}checked{% endif %} required>
                <label class="form-check-label" for="inlineRadio9">새차</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="used" id="inlineRadio10" value="False" {% if car and car['used'] %}checked{% endif %}>
                <label class="form-check-label" for="inlineRadio10">중고</label>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <label for="vin" class="col-sm-2 col-form-label">VIN 넘버</label>
        <div class="col-sm-3">
            <input type="text" name="vin" id="vin" class="form-control" {% if car %}value="{{ car['vin'] }}"{% endif %} required>
        </div>
    </div>
    <div class="form-group row">
        <label for="mileage" class="col-sm-2 col-form-label">마일리지</label>
        <div class="col-sm-3">
            <input type="number" name="mileage" id="mileage" class="form-control" min="0" {% if car %}value="{{ car['mileage'] }}"{% endif %} required>
        </div>
    </div>
    <div class="form-group row">
        <label for="year" class="col-sm-2 col-form-label">년식 (yyyy)</label>
        <div class="col-sm-3">
            <input type="number" name="year" id="year" class="form-control" min="1900" {% if car %}value="{{ car['year'] }}"{% endif %} required>
        </div>
    </div>
    <div class="form-group row">
        <label for="displacement" class="col-sm-2 col-form-label">배기량 (cc)</label>
        <div class="col-sm-2">
            <input type="number" name="displacement" id="displacement" class="form-control" min="0" {% if car %}value="{{ car['displacement'] }}"{% endif %} required>
        </div>
    </div>
    <div class="form-group row">
        <label for="accident" class="col-sm-2 col-form-label">사고횟수</label>
        <div class="col-sm-1">
            <input type="number" name="accident" id="accident" class="form-control" min="0" {% if car %}value="{{ car['accident'] }}"{% endif %} required>
        </div>
    </div>
    <div class="form-group row">
        <label for="price" class="col-sm-2 col-form-label">가격 ($)</label>
        <div class="col-sm-3">
            <input type="number" name="price" id="price" class="form-control" min="0" {% if car %}value="{{ car['price'] }}"{% endif %} required>
        </div>
    </div>
    <div class="form-group">
        <label for="description">상세설명</label>
        <textarea name="description" id="description" class="form-control" rows="5" placeholder="기타 상세정보">{% if car %}{{ car['description'] }}{% endif %}</textarea>
    </div>
    <hr>
    <label for="file1">사진첨부 (jpg, png only) 최대 8장.</label>
    {% if car %}
    {% for idx, image in car['image'] %}
    <div class="form-group">
        {% if image %}
        <div id="imagecontainer{{idx}}">
            <img src="{{ image }}"style="width:10rem;">
            <a class="btn btn-lg" href="#collapsefile{{idx}}" data-toggle="collapse" aria-expanded="false" aria-controls="collapsefile{{idx}}" onclick="removeimg({{idx}})">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-pencil" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5L13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175l-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/>
                </svg>
            </a>
        </div>
        <div class="collapse" id="collapsefile{{idx}}">
            <input type="file" class="form-control-file" name="file{{idx+1}}">
        </div>
        {% else %}
        <input type="file" class="form-control-file" name="file{{idx+1}}">
        {% endif %}
    </div>
    {% endfor %}
    {% else %}
    <div class="form-group">
        <input type="file" class="form-control-file" name="file1">
    </div>
    <div class="form-group">
        <input type="file" class="form-control-file" name="file2">
    </div>
    <div class="form-group">
        <input type="file" class="form-control-file" name="file3">
    </div>
    <div class="form-group">
        <input type="file" class="form-control-file" name="file4">
    </div>
    <div class="form-group">
        <input type="file" class="form-control-file" name="file5">
    </div>
    <div class="form-group">
        <input type="file" class="form-control-file" name="file6">
    </div>
    <div class="form-group">
        <input type="file" class="form-control-file" name="file7">
    </div>
    <div class="form-group">
        <input type="file" class="form-control-file" name="file8">
    </div>
    {% endif %}
    <div class="row justify-content-center">
        <button type="submit" class="btn btn-success col-auto">
            {% if car %}
            수정
            {% else %}
            등록
            {% endif %}
        </button>
    </div>
</form>
{% endblock %}

{% block custom_javascript %}
<script>
    function removeimg(idx){
        var imgobj = document.getElementById("imagecontainer"+idx);
        imgobj.remove();
        
    }
</script>
{% endblock %}